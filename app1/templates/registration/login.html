<!-- filepath: c:\python\django\pagina\app1\templates\registration\login.html -->
{% extends 'app1/base.html' %}

{% block title %}Iniciar Sesión{% endblock %}

{% block content %}
  <div class="container mt-5">
    <div class="row justify-content-center">
      <div class="col-md-6">
        <h2>Iniciar Sesión</h2>
        <hr>

        {% if form.errors %}
          <div class="alert alert-danger">
            Tu nombre de usuario y contraseña no coinciden. Por favor, inténtalo de nuevo.
          </div>
        {% endif %}

        {% if next %}
          {% if user.is_authenticated %}
            <p class="alert alert-warning">Tu cuenta no tiene acceso a esta página. Para continuar,
            por favor inicia sesión con una cuenta que tenga acceso.</p>
          {% else %}
            <p class="alert alert-info">Por favor, inicia sesión para ver esta página.</p>
          {% endif %}
        {% endif %}

        <form method="post" action="{% url 'login' %}">
          {% csrf_token %}

          <div class="mb-3">
             <label for="{{ form.username.id_for_label }}" class="form-label">{{ form.username.label }}</label>
             {{ form.username }}
             {% if form.username.errors %}
                 <div class="invalid-feedback d-block">
                     {% for error in form.username.errors %}
                         {{ error }}
                     {% endfor %}
                 </div>
             {% endif %}
          </div>

          <div class="mb-3">
            <label for="{{ form.password.id_for_label }}" class="form-label">{{ form.password.label }}</label>
            {{ form.password }}
            {% if form.password.errors %}
                <div class="invalid-feedback d-block">
                    {% for error in form.password.errors %}
                        {{ error }}
                    {% endfor %}
                </div>
            {% endif %}
          </div>

          <button type="submit" class="btn btn-primary">Iniciar Sesión</button>
          <input type="hidden" name="next" value="{{ next }}">
        </form>

        {# Asume que tienes URLs para reseteo de contraseña y registro #}
        <p class="mt-3">
          <a href="{% url 'password_reset' %}">¿Olvidaste tu contraseña?</a>
        </p>
        <p>
          ¿No tienes cuenta? <a href="{% url 'register' %}">Regístrate aquí</a> {# CAMBIO: Quitado 'app1:' #}
        </p>
      </div>
    </div>
  </div>
{% endblock %}